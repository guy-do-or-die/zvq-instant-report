/*
 * jquery.urlive.min.js v1.0.4, jQuery URLive
 *
 * View the plugin repository at:
 * https://github.com/markserbol/urlive
 *
 */

(function(a){var l={container:".urlive-container",target:"_blank",imageSize:"auto",render:!0,disableClick:!1,callbacks:{onStart:function(){},onSuccess:function(){},onFail:function(){},noData:function(){},onLoadEnd:function(){},imgError:function(){},onClick:function(){}}},m=function(c){var d=RegExp(location.protocol+"//"+location.hostname),e="http"+(/^https/.test(location.protocol)?"s":"")+"://query.yahooapis.com/v1/public/yql?callback=?";return function(b){var k=b.url;/get/i.test(b.type)&&!/json/i.test(b.dataType)&&!d.test(k)&&/:\/\//.test(k)&&(b.url=e,b.dataType="json",b.data={q:'select * from html where url="{URL}" and xpath="*" and compat="html5"'.replace("{URL}",k+(b.data?(/\?/.test(k)?"&":"?")+a.param(b.data):"")),format:"xml"},!b.success&&b.complete&&(b.success=b.complete,delete b.complete),b.success=function(a){return function(c){a&&a.call(this,{responseText:(c.results[0]||"").replace(/<script[^>]+?\/>|<script(.|\s)*?\/script>/gi,"")},"success")}}(b.success));return c.apply(this,arguments)}}(a.ajax),e=function(){var c=a(this).data("urlive-container")||a(this);return a(c).find(".urlive-link")},h={init:function(c){var d=a.extend(!0,l,c);return this.each(function(){function c(a){if(/\.(?:jpe?g|gif|png)/.test(a)){var d=a.substr(a.lastIndexOf("/")+1);e({image:a,title:d,url:a})}else b(a)}function b(c){m({url:c,type:"GET",beforeSend:d.callbacks.onStart}).done(function(b){b=b.results;a.isEmptyObject(b)?d.callbacks.noData():(b=b[0],html=a("<div/>",{html:b}),get=function(a){return html.find('[property="'+a+'"]').attr("content")||html.find('[name="'+a+'"]').attr("content")||html.find(a).html()||html.find(a).attr("src")},set={image:get("og:image")||get("img"),title:get("og:title")||get("title"),url:get("og:url")||c,description:get("og:description"),type:get("og:type"),sitename:get("og:site_name")},d.callbacks.onSuccess(set),d.render&&e(set))}).fail(function(c,b,e){a.error("YQL request error: ",b,e);d.callbacks.onFail()})}function e(c){anchor=a("<a/>",{"class":"urlive-link",href:c.url,target:d.target});imgWrapper=a("<div/>",{"class":"urlive-img-wrapper"});textWrapper=a("<div/>",{"class":"urlive-text-wrapper"});a.each(c,function(c,b){b&&("image"==c?(img=a("<img/>",{src:b}),img.error(d.callbacks.imgError),img.appendTo(imgWrapper),img.hide().load(function(){var b=a(this).width(),e=a(this).closest(".urlive-link");a(this).addClass("urlive-"+c).show();"auto"==d.imageSize?b>=e.width()?e.addClass("urlive-img-large"):e.addClass("urlive-img-small"):"large"==d.imageSize?e.addClass("urlive-img-large"):"small"==d.imageSize&&e.addClass("urlive-img-small");d.callbacks.onLoadEnd()})):(elem=a("<span/>",{"class":"urlive-"+c,text:b}),elem.appendTo(textWrapper)))});anchor.append(imgWrapper,textWrapper).appendTo(g.data("urlive-container"));anchor.on("click",d.callbacks.onClick);if(d.disableClick)anchor.on("click",function(a){a.preventDefault()})}var g=a(this),f;g.data("urlive-container",d.container);if(g.is("a"))f=g.attr("href"),c(f);else{f=g.val()||g.text();var h=/((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/i;h.test(f)&&(f=h.exec(f)[0],c(f))}})},close:function(a){e.apply(this).fadeOut(a)},remove:function(a){var d=e.apply(this);a?d.fadeOut(a,function(){d.remove()}):d.remove()},open:function(a){e.apply(this).fadeIn(a)},disable:function(){e.apply(this).on("click",function(a){a.preventDefault()})},enable:function(){e.apply(this).off("click")}};a.fn.urlive=function(c){if(h[c])return h[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)a.error('Method "'+c+'" does not exist on jquery.urlive');else return h.init.apply(this,arguments)}})(jQuery);